define(["require","exports","ekyna-modal","../dispatcher","../document-manager"],function(e,t,i,r,u){"use strict";function n(e,t){this.window=t,this.$element=e,this.updated=!1}Object.defineProperty(t,"__esModule",{value:!0}),t.BasePlugin=void 0,n.setup=function(){return new Promise(function(e,t){e()})},n.tearDown=function(){return new Promise(function(e,t){e()})},n.prototype.isUpdated=function(){return this.updated},n.prototype.edit=function(){this.destroyed=!1},n.prototype.save=function(){var n=this;return new Promise(function(e,t){if(n.isUpdated())throw"Plugin has updates.";e()})},n.prototype.destroy=function(){var e=this;return this.save().then(function(){e.modal&&(e.modal.close(),e.modal=null),e.destroyed=!0})},n.prototype.preventDocumentSelection=function(e){return!1},n.prototype.setUpdated=function(e){this.updated=e},n.prototype.openModal=function(e,n){var o=this;r.default.trigger("editor.set_busy"),this.modal=new i,this.modal.load({url:e,method:"GET"}),$(this.modal).on("ekyna.modal.response",function(e){var t;"json"==e.contentType&&(e.preventDefault(),u.BaseManager.parse(e.content),(t=new u.SelectionEvent).$element=o.$element,r.default.trigger("document_manager.select",t),e.modal.close()),n&&n(e)}).on("ekyna.modal.show",function(){r.default.trigger("editor.unset_busy")}).on("ekyna.modal.hide",function(){r.default.trigger("editor.unset_busy")})},t.BasePlugin=n});