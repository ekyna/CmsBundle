var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};define(["require","exports","underscore","./Dispatcher","./Ui"],function(a,b,c,d,e){"use strict";var f=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.initialize=function(a,b){var d=this;this.set("id","editor-control-bar"),this.addButton("default",new e.Button({name:"power",title:"Toggle editor on/off",size:"md",theme:"primary",icon:"power-off",event:"controls.power.click"})),this.addButton("default",new e.Button({name:"reload",title:"Reload the page",size:"md",theme:"default",icon:"refresh",event:"controls.reload.click",spinning:!0})),b.viewports&&c.forEach(b.viewports,function(a){d.addButton("viewport",new e.Button({name:a.name,title:a.title,size:"md",icon:a.icon,event:"controls.viewport.click",rotate:!1,active:a.active,data:{width:a.width,height:a.height}}))})},b}(e.Toolbar);b.ControlsModel=f;var g=function(a){function b(b){a.call(this,b),this.template=c.template('\n            <div id="editor-control-main" class="btn-group"></div>\n            <div id="editor-control-viewport" class="btn-group"></div>\n        ')}return __extends(b,a),b.prototype.initialize=function(a){var b=this;d["default"].on("controls.power.click",function(a){a.set("active",!a.get("active"))}),d["default"].on("controls.viewport.click",function(a){b.model.getGroup("viewport").get("buttons").reject(function(b){return b==a}).forEach(function(a){return a.deactivate()}),a.get("active")?"Adjust"!=a.get("name")&&a.set("rotate",!a.get("rotate")):a.set("active",!0)}),d["default"].on("viewport_iframe.unload",function(){return b.setBusy()}),d["default"].on("viewport_iframe.load",function(){return b.unsetBusy()})},b.prototype.setBusy=function(){this.model.getButton("default","reload").activate().startSpinning()},b.prototype.unsetBusy=function(){this.model.getButton("default","reload").deactivate().stopSpinning()},b}(e.ToolbarView);b.ControlsView=g});