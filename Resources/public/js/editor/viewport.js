var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}();define(["require","exports","jquery","backbone","underscore","./dispatcher","./ui"],function(u,t,e,i,r,o,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewportView=t.ViewportModel=void 0;n=i.Model,__extends(l,n),l.prototype.defaults=function(){return{size:null}};var n,a=l;function l(){return null!==n&&n.apply(this,arguments)||this}t.ViewportModel=a;s=i.View,__extends(d,s),d.prototype.initialize=function(t){r.bindAll(this,"resize","reload"),this.model.bind("change:size",this.resize),e(window).resize(this.resize)},d.prototype.reload=function(){this.iFrame.contentWindow.location.reload()},d.prototype.onViewportButtonClick=function(t){var e=null,i=t.get("data");0<i.width&&0<i.height&&(e=t.get("rotate")?{width:i.height,height:i.width}:{width:i.width,height:i.height}),this.model.set("size",e)},d.prototype.render=function(){return this.$el.html(this.template()),this.resize(),this},d.prototype.load=function(t){this.iFrame.src=h.Util.addEditorParameterToUrl(t)},d.prototype.initIFrame=function(t){var e=this;return this.iFrame=document.getElementById("editor-viewport-frame"),this.iFrame.onload=function(){o.default.trigger("viewport_iframe.load",e.iFrame.contentWindow||e.iFrame,e.iFrame.contentDocument),e.iFrame.contentWindow.onbeforeunload=function(t){if(o.default.trigger("viewport_iframe.unload",t),t.returnValue)return t.returnValue}},this.load(t),this},d.prototype.resize=function(){var t=window.document.querySelector("#editor-viewport").offsetWidth,e=this.model.get("size"),i={top:50,left:0};this.$el.removeAttr("style"),e?(this.$el.removeClass("auto").css({width:e.width,height:e.height}),e.width>t-25?i.left=25:i.left=t/2-e.width/2,i.top=75):this.$el.addClass("auto"),o.default.trigger("viewport.resize",{origin:i,size:e})};var s,a=d;function d(t){var e=this;return t.tagName="div",t.attributes={id:"editor-viewport-wrapper"},(e=s.call(this,t)||this).template=r.template('<iframe id="editor-viewport-frame" frameborder="0"></iframe>'),e.onControlsReloadClickHandler=function(t){return e.reload()},e.onControlsViewportClickHandler=function(t){return e.onViewportButtonClick(t)},e.onDocumentManagerNavigateHandler=function(t){return e.load(t)},e}t.ViewportView=a});