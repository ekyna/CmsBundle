var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};define(["require","exports","jquery","backbone","underscore","./dispatcher","./ui"],function(a,b,c,d,e,f,g){"use strict";var h=function(a){function b(){return a.apply(this,arguments)||this}return __extends(b,a),b.prototype.defaults=function(){return{size:null}},b}(d.Model);b.ViewportModel=h;var i=function(a){function b(b){var c;return b.tagName="div",b.attributes={id:"editor-viewport-wrapper"},c=a.call(this,b)||this,c.template=e.template('<iframe id="editor-viewport-frame" frameborder="0"></iframe>'),c.onControlsReloadClickHandler=function(a){return c.reload()},c.onControlsViewportClickHandler=function(a){return c.onViewportButtonClick(a)},c.onDocumentManagerNavigateHandler=function(a){return c.load(a)},c}return __extends(b,a),b.prototype.initialize=function(a){e.bindAll(this,"resize","reload"),this.model.bind("change:size",this.resize),c(window).resize(this.resize)},b.prototype.reload=function(){this.iFrame.contentWindow.location.reload()},b.prototype.onViewportButtonClick=function(a){var b=null,c=a.get("data");0<c.width&&0<c.height&&(b=a.get("rotate")?{width:c.height,height:c.width}:{width:c.width,height:c.height}),this.model.set("size",b)},b.prototype.render=function(){return this.$el.html(this.template()),this.resize(),this},b.prototype.load=function(a){this.iFrame.src=g.Util.addEditorParameterToUrl(a)},b.prototype.initIFrame=function(a){var b=this;return this.iFrame=document.getElementById("editor-viewport-frame"),this.iFrame.onload=function(){f["default"].trigger("viewport_iframe.load",b.iFrame.contentWindow||b.iFrame,b.iFrame.contentDocument),b.iFrame.contentWindow.onbeforeunload=function(a){if(f["default"].trigger("viewport_iframe.unload",a),a.returnValue)return a.returnValue}},this.load(a),this},b.prototype.resize=function(){var a=window.document.querySelector("#editor-viewport"),b=a.offsetWidth,c=(a.offsetHeight,this.model.get("size")),d={top:50,left:0};this.$el.removeAttr("style"),c?(this.$el.removeClass("auto").css(c),c.width>b-25?d.left=25:d.left=b/2-c.width/2,d.top=75):this.$el.addClass("auto"),f["default"].trigger("viewport.resize",{origin:d,size:c})},b}(d.View);b.ViewportView=i});